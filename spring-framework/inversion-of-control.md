# 제어의 역전

제어의 역전(Inversion of Control)이란, 프로그램의 제어 흐름 구조가 뒤바뀌는 것을 말한다.
IoC라는 약자로 많이 사용된다.

## 일반적인 프로그램의 흐름
일반적으로 프로그램의 흐름은 main()메소드와 같이 프로그램이 시작되는 지점에서 다음에 사용할 오브젝트를 결정하고, 결정한 오브젝트를 생성, 만들어진 오브젝트에 있는 메소드 호출을 하는 식의 작업이 반복된다.
이런 프로젝트 구조에서 각 오브젝트는 프로그램 흐름을 결정하거나 사용할 오브젝트를 구성하는 작업에 능동적으로 참여한다.
모든 오브젝트가 능동적으로 자신이 사용할 클래스를 결정하고, 언제 어떻게 그 오브젝트를 만들지를 스스로 관장한다.
모든 종류의 작업을 사용하는 쪽에서 제어하는 구조이다.

## 제어의 역전이 일어날 때의 흐름
제어의 역전이란 제어 흐름의 개념을 거꾸로 뒤집는 것이다.
제어의 역전에서는 오브젝트가 자신이 사용할 오브젝트를 스스로 선택하지 않는다.
당연히 생성하지도 않는다.
또 자신도 어떻게 만들어지고 어디서 사용되는지를 알 수 없다.
모든 제어 권한을 자신이 아닌 다른 대상에게 위임하기 때문이다.

ex) 추상 UserDao를 상속한 서브클래스는 getConnection()메소드를 구현한다.
메소드가 언제 어떻게 사용될지 자신은 모른다. 
단지 이렇게 만들어 놓으면 슈퍼클래스인 UserDao의 템플릿 메소드인 add(), get() 등에서 필요할 때 호출해서 사용되도록 한다는 제어의 역전 개념을 발견할 수 있다.

# 스프링의 IoC
 
 ## 오브젝트 팩토리를 이용한 스프링 Ioc
 스프링에서는 스프링 제어권을 가지고 직접 만들고 관계를 부여하는 오브젝트를 `빈`이라고 한다.
 빈의 생성과 관계설정 같은 제어를 담당하는 IoC 오브젝트를 `빈 팩토리`라고 한다.
 보통 빈 팩토리보다는 이를 좀 더 확장한 애플리케이션 컨텍스트를 주로 사용한다.
 애플리케이션 컨텍스트는 별도의 정보를 참고해서 빈(오브젝트)의 생성, 관계설정 등의 제어 작업을 총괄한다.

 ## 애플리케이션 컨텍스트의 동작방식
 * 클라이언트는 구체적인 팩토리 클래스를 알 필요가 없다.

클라이언트가 필요한 오브젝트를 가져오려면 어떤 팩토리 클래스를 사용해야 할지 알아야 하고, 필요할 때마다 팩토리 오브젝트를 생성해야 하는 번거로움이 있다.
애플리케이션 컨텍스트를 사용하면 오브젝트 팩토리가 아무리 많아져도 이를 알아야 하거나 직접 사용할 필요가 없다.
일관된 방식으로 원하는 오브젝트를 가져올 수 있다.

* 애플리케이션 컨텍스트는 종합 IoC 서비스를 제공해준다.

애플리케이션 컨텍스트의 역할은 단지 오브젝트 생성과 다른 오브젝트와의 관계설정 만이 전부가 아니다.
오브젝트가 만들어지는 방식, 시점과 전략, 자동생성, 오브젝트에 대한 후처리, 정보의 조합, 설정 방식의 다변화, 인터셉팅 등 오브젝트를 효과적으로 활용할 수 있는 다양한 기능을 제공한다.

* 애플리케이션 컨텍스트는 빈을 검색하는 다양한 방법을 제공한다.

애플리케이션 컨텍스트의 getBean() 메소드는 빈의 이름을 이용해 빈을 찾아준다.
타입만으로 빈을 검색하거나, 특별한 애노테이션이 설정되어 있는 빈을 찾을 수도 있다.

## 스칑 IoC 용어 정리
* 빈 (Bean)
빈 또는 빈 오브젝트는 스프링이 IoC 방식으로 관리하는 오브젝트라는 뜻.
주의할 점은 스프링을 사용하는 애플리케이션에서 만들어지는 모든 오브젝트가 다 빈은 아니다.
그 중에서 스프링이 직접 그 생성과 제어를 담당하는 오브젝트만을 빈이라고 부른다.

* 빈 팩토리 (Bean Factory)
스프링의 IoC를 담당하는 핵심 컨테이너를 가리킨다.
빈을 등록하고, 생성하고, 조회하고, 돌려주고, 그 오에 부가적인 빈을 관리하는 기능을 담당한다.
보통은 빈 팩토리를 바로 사용하지 않고, 이를 확장한 애플리케이션 컨텍스트를 사용한다.
BeanFactory라고 붙여쓰면 빈 팩토리가 구현하고 있는 가장 기본적인 인터페이스 이름이 된다.
(해당 인터페이스에는 getBean()과 같은 메소드가 정의되어 있다.)

* 애플리케이션 컨텍스트 (Application Context)
빈 팩토리를 확장한 IoC 컨테이너이다.
빈을 등록하고 관리하는 기본적인 기능은 빈 팩토리와 동일하다. + 스프링이 제공하는 각종 부가 서비스를 추가로 제공한다.
빈 팩토리라고 부를 때는 주로 빈의 생성과 제어의 관점에서 이야기하는 것이고, 애플리케이션 컨텍스트라고 할 때는 스프링이 제공하는 애플리케이션 지원 기능을 모두 포함해서 이야기하는 것이다.
ApplicationContext라고 적으면 애플리케이션 컨텍스트가 구현해야 하는 기본 인터페이스를 가리킨다.
ApplicationContext는 BeanFactory를 상속한다.


* 설정정보 / 설정 메타 정보 (Configuration Metadata)
애플리케이션 컨텍스트 또는 빈 팩토리가 IoC를 적용하기 위해 사용하는 메타정보를 말한다.
IoC 컨테이너에 의해 관리되는 애플리케이션 오브젝트를 생성하고 구성할 때 사용된다.
애플리케이션의 전체 그림이 그려진 청사진이라고도 부른다.

* 컨테이너 (Contatiner) 또는 IoC 컨테이너
IoC 방식으로 빈을 관리한다는 의미에서 애플리케이션 컨텍스트나 빈 팩토리를 컨테이너 또는 IoC 컨테이너라고도 한다.
컨테이너란 단어 자체가 IoC의 개념을 담고 있기 때문에 이름이 긴 애플리케이션 컨텍스트 대신에 스프링 컨테이너라고 부르기도 한다.
컨테이너라는 말은 애플리케이션 컨텍스트보다 추상적인 표현이다.
애플리케이션 컨텍스트는 그 자체로 ApplicationContext 인터페이스를 구현한 오브젝트를 가리키기도 하는데, 애플리케이션 컨텍스트 오브젝트는 하나의 애플리케이션에서 보통 여러 개가 만들어져서 사용된다. 이를 통틀어 스프링 컨테이너라 부르기도 한다.

* 스프링 프레임워크
IoC 컨테이너, 애플리케이션 컨텍스트를 포함해서 스프링이 제공하는 모든 기능을 통틀어 말할 때 주로 사용한다.
보통은 줄여서 스프링이라고 부른다.
