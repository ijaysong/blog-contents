# 머신러닝

## 머신러닝이란?
기계를 학습시켜 인간의 판단을 기계가 내릴 수 있도록 하는 기술이다.

우리는 비교와 선택을 통해 결정을 내린다.
비교는 기계적이다. 크고 작음을 비교해서 더 유리한 쪽으로 선택하면 된다.
문제는 비교가 쉽지 않다는 것이다.
대소관계가 없거나, 비교해야 할 특징이 너무 많을 떄 그렇다.

우리의 현실 또한 그렇다.
너무나도 복잡해서 선택이 어려운 순간이 많다.

인류는 더 나은 선택을 하기 위해 발전해 왔는데,
그 중 하나가 숫자이다.
숫자로 대소관계를 표준화시켰으며, 통계학을 연구하며 더 나은 선택을 도모했다.
이러한 노력을 통해 인류의 선택 과정이 비약적으로 발전했다.

머신러닝은 우리의 두뇌로 내릴 수 있는 선택을 도와주는 기술이다.
자동차가 발명되었다고 해서 다리가 필요 없는 것이 아니고,
망원경이 있다고 해서 눈이 필요없는 것이 아니듯이.
우리가 가진 다리와 눈의 기능과 능력을 확장시키듯 뇌의 기능과 선택의 효율을 높여준다.

## 꿈
특정 상황을 감지하여 알려주는 환경을 구현하고자 한다.
ex)
내가 손톱을 꺠무는 습관이 있는데
이 습관을 고치려면 손톱을 꺠물때마다 알려주면, 그걸 인지하고 고칠 수 있을 것이다.

## 궁리하는 습관
습관을 고치는 어플리케이션을 만들고자 한다.
ex)
손을 깨물고 있는 입 사진과 
평범한 입 사진을 머신러닝으로 학습시킨다.

이런 식으로 학습시키면, 보여준 적이 없는 사진 임에도 손톱을 깨물고 있는지, 아닌지 구분한다.

## Teachable machine
머신러닝에 대한 지식이 없어도 머신러닝을 사용할 수 있도록 한 도구.
ex) https://teachablemachine.withgoogle.com

이미지와 소리(오디오), 자세에 대한 내용을 기계에게 학습시킬 수 있다.
연관된 사진을 class에 한데 모아서 분류한다.
해당 이미지들을 기계에 학습을 시킨다.
더 많은 사진을 등록하거나, 부정확한 사진을 제외하면 머신러닝의 정확도가 높아진다.
사람이 경험을 통해 정교한 판단력을 가지게 되는 것과 비슷하다.
이러한 과정을 기계학습(Machine Learning)이라고 한다.
학습을 통해서 기계는 판단력을 가지게 된다.

ex) 손톱을 무슨 습관을 고칠 있도록 머신러닝을 하고 싶다.
class 1에는 손톱을 물고 있는 사진들을,
class 2에는 일반 사진을 등록한다.

## 모델
경험을 통해 얻게된 판단 능력을 교훈이라고 한다.
교훈 덕분에 경험해보지 않아도 추측, 혹은 판단 할 수 있다.

머신러닝이란 바로 판단력을 기계에게 부여하는 작업이라고 할 수 있다.
머신러닝을 판단력을 모델(Model)이라고 부른다.
모델을 만드는 과정을 학습이라고 한다.
ex)
기계가 손톱을 깨무는지 안깨무는지 판단하는 기준을 갖도록 (모델)
손톱을 물고 있는 사진과 안물고 있는 사진을 보여주어 판단력을 기르게 한다. (학습)

모델을 잘 만들면 좋은 추측을 하게 되고,
추측이 정확해야 좋은 결정을 하게 된다.

## 프로그래밍
애플리케이션과 프로그램은 같은 것을 가리키는 다른 표현이다.
애플리케이션은 응용이라고 하는데, 어떤 부품을 조합(응용)해서 만든 것이다. 
머신러닝은 모델을 응용해서 만든 것이다. 그러므로 머신러닝 애플리케이션이라고 할 수 있다.

프로그램은 음악회에서 시간 순서에 따라 연주되는 음악의 나열을 의미한다.
그래서 프로그램이라는 단어에는 시간과 순서의 의미가 담겨있다.
머신러닝도 마찬가지이다.
손톱을 깨물고 있는 모습을 발견을 하면, 손톱을 깨물고 있음을 판단하고, 모니터에 표시하는 일련의 흐름을 가지고 있기 때문에 프로그램이라고 할 수 있다.
그래서 기계가 프로그램의 흐름대로 동작하는 것을 programming이라고 하고,
이러한 동작을 제어하고 조작하는 사람을 programmer라고 하는 것이다.

사물을 제어하는 프로그래밍을 시간의 흐름에 따라 살펴보자면, 사물 인터넷, IOT(Internet Of Things) 이라는 것이 있다.
전등이나 자동차 등에 작은 컴퓨터가 내장되어 있어 어플을 이용해 동작을 제어할 수 있다.
인터넷 접속을 통해 여러 사물과 연결되어 제어할 수 있게 되는 것이다.
(사물인터넷 = 코딩 + 네트워크 + 전자공학 + 기계공학)

두번째, 머신러닝이다.
어떤 기능을 수행할지 장치 스스로 판단한다.
장치에 연결된 여러가지 센서들을 통해서 데이터를 수집하고, 데이터의 의미를 머신러닝의 모델이 판단한다.
판단의 결과에 따라 머신러닝 스스로 행동 할 수 있게 되는 것이다.
ex) 불을 켜기도 하고, 자동차 핸들을 움직이기도 한다.

ex) 
레모네이트를 판매하는 카페라고 생각해보자.
레몬을 적게 준비했더니 손님이 찾는만큼 판매하지 못했고,
레몬을 많이 준비했더니 남아서 버려야 했다.
적당한 양을 준비해서 판매하고 있는데
온도와 판매량에 일정한 연관관계가 있다는 것을 발견했다.
하지만 온도 외에도 요일이나 날짜 등등의 영향도 받고 있어 판매량을 구하는 모델을 구하는 것이 쉽지 않다.(사람이 모든 요소의 영향력을 고려하여 모델을 세우는 것은 쉽지 않은 일)
하지만 러닝머신을 이용하면 판매량(=레몬양)을 구하는 공식을 산출해낼 수 있다.

## 데이터 과학이란? 데이터 공학이란?
머신러닝을 하려면 수 많은 데이터가 필요하다.
우리의 삶은 모두 데이터로 표현될 수 있다.
복잡한 현실에서 우리의 관심사만 뽑아서 단순한 데이터로 만들어야 한다.
현실을 데이터화 할 수 있다면, 복잡한 현실에 대한 통찰을 얻을 수 있을 것이다.
이렇게 현실의 데이터를 다루는 산업 분야가 있는데
데이터 과학(Data Science)과 데이터 공학(Data Engineering)이 있다. 
데이터 과학은 데이터를 만들고, 만들어진 데이터를 활용한다.
ex) 
책에 비유하자면, 작가
데이터 공학은 도구를 만들고, 도구를 관리하는 일을 한다.
ex)
책에 비유하자면, 종이, 연필, 혹은 책을 관리하는 도서관의 역할

데이터 과학은 데이터 자체를 다루는 학문이라면, 데이터 공학은 데이터를 다룰 수 있도록 도와주는 학문이라고 할 수 있다.
데이터 과학과 공학은 정신과 육체처럼 뗄레야 뗄 수 없는 관계이다. 사실상 하나라고 봐도 무방하다.

## 표
표는 행(Row)과 열(Column)로 이루어져 있다.
행은 하루하루 이고, 열은 하루의 속성을 나타낸다.
표를 DataSet 이라고도 한다. 
데이터 산업에서는 행과 열을 좀 더 어렵게 부른다.

* 데이터 산업에서 부르는 행
- 개체 (instance)
- 관측치 (observed value)
- 기록 (record)
- 사례 (example)
- 경우 (case)

* 데이터 산업에서 부르는 열
- 특성 (feature)
- 속성 (attribute)
- 변수 (variable)
- field

## 독립변수와 종속변수
변수(variable)란, 변할 수 있는 값을 말한다.
ex) 변수 X : X = 1, X=2 

독립변수 (Independent variable)는 원인이 되는 것을 말한다.
원인은 결과와 상관없이 발생한다.
결과와 상관없이 독립적으로 발생한다고 해서 독립변수이다.

종속변수 (Dependent variable)는 원인으로 인해 결과가 되는 것을 말한다.
결과가 원인에 종속되어 있기 떄문에 종속 변수라고 한다.

ex)
온도는 원인(독립변수)이고, 판매량은 결과(종속변수)이다.
| 날짜 | 요일 | 온도 | 판매량 |
|-----|-----|-----|------|
| 2021/5/3 | 금 | 20 | 40 |
| 2021/5/4 | 토 | 21 | 42 |
| 2021/5/5 | 일 | 22 | 44 |

이제 표를 보면 떠올려야 할 것이 있다.
* 이 표에 있는 특성들 중에서 서로 상관있는 특성은 무엇이지?
한쪽의 값이 바뀔 때 다른 쪽도 값이 바뀐다면 서로 연관이 있다고 할 수 있다.
이러한 관계를 상관관계라고 한다.

상관관계는 인과관계를 포함한다. 인과관계보다 더 큰 개념이다.
모든 인과관계는 상관관계이지만,
모든 상관관계가 인과관계인 것은 아니다.

## 머신러닝의 분류
머신러닝은 하나의 단위 도구가 아니다.
머신러닝의 이름 아래에 다양한 이름을 가진 기능들이 있다.
대표적인 기능들에 대해 살펴보자.
1. 지도학습 (supervised learning)
기계를 가르친다는 의미이다.
기계를 점점 가르치다 보면 비슷한 문제에 대해 잘 대응할 수 있게 된다.

   1-1. 분류 (classification)
   1-2. 회귀 (regression)
2. 비지도학습 (unsupervised learning)
기계에 통찰력을 가르치는 학습 과정을 말한다.
통찰력이란 사물을 꿰뚫는 예리한 관찰력을 말하는데,
누가 가르쳐주지 않아도 사물이나 데이터에 대한 예리한 관찰력으로 의미나 관계를 밝혀내는 것이다.
   2-1. 군집화 (clustering)
   2-2. 변환 (transform)
   2-3. 연관 (association)
3. 강화학습 (reinforcement learning) 
학습을 통해 능력을 강화시킨다는 점에서 지도학습과 비슷하지만,
지도학습은 문제집에 정답이 있는 것처럼 정해진 답을 가지고 학습 시키는 것이라면,
강화학습은 어떻게 하면 더 나은 결과를 낼 수 있을지 스스로 느끼고 노력하면서 실력 향상을 위해 힘쓴다는 점에서 다르다.
경험이라는 수련을 통해 실력을 키워나가는 것이다.

## 지도학습 (Supervised Learning)
지도학습은 역사와 비슷하다.
역사는 과거에 있었던 사건이 원인과 결과로 기록되어 있다.
지도학습은 주로 과거의 데이터를 활용하여 미래의 추측을 하는데 활용한다.

지도학습을 하기 위해선 과거의 데이터가 필요하다.
과거의 데이터를 독립 변수와 종속 변수로 분리한다.
컴퓨터에 독립 변수와 종속 변수를 인지시키면 컴퓨터는 그 공식을 산출해낸다.(모델)
산출해낸 모델을 활용하여 구하고자 하는 값을 순식간에 계산하여 제시한다.

과거에는 이러한 공식을 구하기 위해서 고도의 실험과 수학적 능력이 필요했다.
그래서 공식이란 엘리트들의 전유물이였고, 다른 사람들은 엘리트들이 구해놓은 공식을 사용하는 소비자의 입장이였다.
하지만 지금은 적은 지식과 노력으로도 나의 공식을 만들어서 사용할 수 있게 되었다.(생산자의 입장)
공식의 대중화가 이루어진 것이다!

##  회귀
지도학습은 분류(Classification)와 회귀(Regression)로 나눌 수 있다.
예측하고자 하는 종속 변수가 숫자일 때 주로 회귀를 사용한다.

ex) 회귀의 사례
| 독립변수 | 종속 변수 | 학습 시킬 데이터를 만드는 방법 | 
|--------|---------|------------------------|
| 공부시간 | 시험점수 (10점, 20점) | 사람들의 공부시간을 입력받고 점수를 확인한다 |
| 온도 | 레모네이드 판매량 | 온도와 그날의 판매량을 기록한다 |
| 역세권, 조망 등 | 집 값 | 집과 역까지의 거리, 수치화된 조망의 평점 등을 집 값과 함께 기록한다 |
| 온실 기체량 | 기온 변화량 | 과거에 배출된 온실 기체량과 기온의 변화량을 기록한다 |
| 자동차 속도 | 충돌 시 사망 확률 | 충돌 시 속도와 사상자를 기록한다 |
| 나이 | 키 | 학생들의 나이에 따른 키를 기록한다 |

## 분류
성격에 맞는 것들끼리 그룹핑 하는 것을 분류라고 한다.
예시로 살펴본 내용 중에 손톱을 깨무는 것을 인지하여 알려주는 머신러닝을 만드는 내용이 있었다.
해당 내용에서 손톱을 깨무는 사진과 손톱을 깨물지 않은 정상 사진을 나눈것도 분류의 한 예시이다. 

분류가 지도학습인 이유는
1. 과거의 데이터를 가지고 학습하기 때문이다.
2. 데이터가 독립변수와 종속변수로 나누어져 있다는 점이다.
독립변수와 종속변수를 통해서 모델을 만든다.
ex) 
사진(손톱을 꺠무는 사진, 정상인 사진) : 독립변수
손톱을 문 상태, 정상 : 종속변수

종속변수가 손톱을 문 상태나 정상과 같은 숫자가 아닌 결과인 경우(이름인 경우)에는 회귀가 아닌 분류를 이용한다.
ex) 분류의 사례
| 독립변수 | 종속변수 | 학습시킬 데이터를 만드는 방법 |
|--------|--------|-----------------------|
| 공부시간 | 합격 여부(합격, 불합격) | 사람들의 공부시간을 입력받고, 최종 합격여부를 확인한다. |
| x-ray 사진과 영상 속 종양의 크기, 두께 | 악성 종양 여부 (양성, 음성) | 의학적으로 양성과 음성이 확인된 사진과 영상 데이터를 모은다. |
| 품종, 산도, 당도, 지역, 연도 | 와인의 등급 | 소믈리에를 통해서 등급이 확인된 와인을 가지고 품종, 산도 등의 독립변수를 측정하고 기록한다. |
| 키, 몸무게, 시력, 지병 | 현역, 공익, 면제 | 키, 몸무게, 시력, 지병들을 토대로 현역, 공익, 면제인지 확인한다. |
| 메일 발신인, 제목, 본문 내용(사용된 단어, 이모티콘 등) | 스팸 메일 여부 | 이제까지 받은 메일을 모으고, 이들을 스팸 메일과 일반 메일로 구분한다. |
| 고기의 지방함량, 지방색, 성숙도, 육색 | 소고기 등급 | 소고기의 정보를 토대로 등급을 측정한다. |

## 비지도학습 (Unsupervised Learning)
## 군집화 (Clustering)
비슷한 것들을 찾아서 그룹을 찾는 것이다.
분류와 개념이 비슷한데, 군집화와 분류의 차이점은 다음과 같다.
* 군집화 : 비슷한 것들끼리 모아서 그룹을 만드는 것
* 분류 : 어떤 대상이 어떤 그룹에 포함되는지 분류하는 것

군집화에 아주 유용한 도구가 있다. 좌표평면이다.
데이터의 특성을 x축과 y축으로 설정하고 각 데이터를 좌표평면 위에 표시한다.
그렇게 표시하다보면 특정 데이터들이 비슷한 위치에 뭉쳐있는데, 이를 하나의 그룹으로 삼는다.
각각의 그룹을 표로 표현하면 이것이 군집화가 되는 것이다.

그런데 그룹이 천만개로 나뉘어진다면 어떻게 될까??
데이터의 특성이 2개가 아니라 30개 이상이라면?
데이터 값이 자꾸 수정되고 삭제된다면?
사람이 할 수 있는 작업이 아니다.
이런 데이터 지옥 속에서 도움을 줄 수 있는 것이 머신러닝이다.

군집화에 1000만개의 관측치를 제공하고 100개의 클러스터 수를 만들라는 제한을 두면
군집화는 서로 다른 갯수의 데이터를 포함하는 클러스터 100개를 생성한다. 
그러면 표 상에서 비슷한 행을 모아 한 그룹으로 그룹핑하는 것이 가능하다.

## 연관규칙학습 (Assocation rule learning)
장바구니 학습이라고도 한다.
고객의 장바구니에 담긴 상품을 바탕으로 연관 제품을 추천하면 더 많이 판매할 수 있다.
ex)
라면과 계란은 연관성이 높은 상품임을 알 수 있다.
라면을 구입했는데 계란을 구입하지 않은 경우, 계란을 추천하면 구매할 가능성이 높다.
| 주문번호 | 라면 | 계란 | 식빵 | 우유 | 햄 |
|--------|-----|-----|-----|-----|---|
| 1 | O | O | X | X | O | 
| 2 | O | O | X | X | X |
| 3 | O | O | X | X | X |
| 4 | X | X | O | O | X |

하지만 수백개의 상품, 수만명의 고객이 존재한다면 제품관의 연관성을 찾기가 쉽지 않다.
이를 도와줄 수 있는 도구가 머신러닝의 비지도 학습 > 연관규칙 > 추천이다.
열간의 연관성을 찾아주는 것, 특성을 그룹핑 해주는 것을 연관규칙이라고 할 수 있다.

## 비지도 학습 정리
비지도 학습은 탐험적이다. 
탐험은 미지의 세계를 파악해가듯이, 비지도 학습도 데이터의 특성을 파악해간다.
독립변수와 종속변수의 구분이 중요하지 않다. 데이터만 있으면 된다.
비지도 학습은 데이터의 성격을 파악하는 것이 목적이다.
비지도 학습의 군집화와 연관규칙학습에 대해 살펴보면 비슷한 것은 모으고, 다른 것은 떨어뜨린다.
비지도 학습은 정리정돈해서 데이터의 특성을 표현하는 것이다.

지도학습은 역사적이다.
과거의 역사를 바탕으로 원인과 결과를 파악한다.
결과를 모르는 원인이 발생 했을 때, 그것은 어떠한 결과를 초래할 지 추측하는 것이 그 목적이다.
그래서 원인인 독립변수와 결과인 종속변수가 꼭 필요하다.

## 강화학습 (Reinforcement Learning)
강화학습의 핵심은 일단 해보는 것이다.
지도학습은 학습을 통해서 익힌다면 강화학습은 경험을 통해 익힌다.
경험을 통해 상과 벌을 받는데, 이러한 과정이 반복되면 상을 받을 확률이 높아진다는 것이 강화학습의 이론이다.

강화학습의 원리를 게임에 빗대어 살펴볼 수 있다.
ex) 
게임은 게이머가 화면을 통해 게임의 현재 상태를 보여준다.
어떤 진행 상황인지, 상과 벌점을 보여준다.
게이머는 장애물에 부딪히면 점수가 낮아지고, 어떻게 하면 점수가 높아지는지 관찰을 통해 어떻게 행동하면 좋을지 판단력이 강화 된다. (강화학습)
판단을 바탕으로 행동하여 게임에 변화를 주게 된다.

이러한 과정을 통해서 점점 게임을 잘하게 된다.
강화학습은 이러한 과정을 모방해서 기계를 학습시키는 것이다.

게임에서의 용어를 강화학습의 용어로 다음과 같이 치환할 수 있다.
| 게임에서의 용어 | 강화학습의 용어 |
|-------------|-------------|
| 게임 | 환경 (environment) |
| 게이머 | 에이전트 (agent) |
| 상태 | 상태 (state) |
| 상/벌 | 보상 (reward) |
| 판단 | 정책 (policy) |
| 행동 | 행동 (action) |

즉, 강화학습은 상태에 따라서 에이전트가 더 많은 보상을 받을 수 있도록 행동하는 것이다.

## 머신러닝 지도
ex) 
레모네이드를 판매하는 카페라고 해보자.
온도에 따른 판매량을 꾸준히 기록해왔다.
해당 데이터를 바탕으로 판매량을 예측하고 싶다.

1. 과거의 데이터를 가지고 있나요? YES
2. 가지고 있는 데이터가 많나요? YES
3. 추측하고 싶은 미지의 종속변수가 있나요? YES
4. 미지의 종속변수가 범주형 데이터인가요? NO (숫자는 범주형 데이터가 아니다.)
4-1. 미지의 종속변수가 양적 데이터인가요? YES
=> 회귀 (레모네이드 판매량은 회귀를 통해서 구할 수 있다.)

이외에 다른 머신러닝 지도에 대해서 살펴보자면
4. 미지의 종속변수가 범주형 데이터인가요? YES
=> 분류

1. 과거의 데이터를 가지고 있나요? NO
1-1. 보상을 되돌려주는 환경이 있나요? 
=> 강화학습

3. 추측하고 싶은 미지의 종속변수가 있나요? NO
3-1. 비슷한 관측지를 그룹핑하고 있나요? YES
=> 군집화

3-1. 비슷한 관측지를 그룹핑하고 있나요? NO
3-2. 특성 사이의 상관관계를 찾고 있나요? YES
=> 연관규칙학습
