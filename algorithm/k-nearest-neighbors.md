# KNN 알고리즘

## 오렌지와 자몽 분류하기
자몽은 오렌지보다 붉고 크다.
* x축 : 크기 (작다-크다)
* y축 : 색상 (오렌지색 - 붉은색)

어떤 과일이 자몽인지 오렌지인지 어떻게 분류할 수 있을까?
그래프 상에서 주변을 둘러보는 것이다.
예를 들어, 가장 가까운 이웃 3개가 오렌지이고 자몽보다 많다면, 이 과일은 아마도 오렌지 일 것이다.

이러한 과정을 통해 분류를 하는 것을 KNN 알고리즘이라고 한다.
1. 분류할 과일이 있다.
2. 가장 가까운 3개의 이웃을 살펴본다.
3. 이웃 중에 오렌지가 많으면 이 과일은 오렌지이다.

## 추천 시스템 만들기
넷플릭스에서 일한다고 생각해보자. 고객을 위한 영화추천 시스템을 만들고 싶다.

우선 모든 고객을 그래프에 그린다.
유사도를 이용하여 고객을 그래프 상에 표현한다. 즉, 서로 취향이 비슷한 고객을 근접한 위치에 그린다.
A라는 고객을 위해 어떤 영화를 추천해야 한다고 가정하자.
A와 취향이 가장 비슷한 다섯 명의 고객을 찾는다.

이 그래프가 있으면 추천 시스템을 만드는 것은 쉽다.
만약 비슷한 취향을 가지고 있는 B가 영화를 좋아한다면 그 영화를 A에게도 추천한다.
1. B가 어떤 영화를 봤다.
2. B는 그 영화가 마음에 든다.
3. A에게 그 영화를 추천한다.

그렇다면 도대체 고객 사이의 유사도는 어떻게 구하는 것일까?

### 특징 추출
자몽 문제에서는 과일의 크기와 불은 정도를 통해 과일을 분류하였다.
이 특징을 이용해서 세 개의 과일을 그래프에 그릴 수 있다.

|비교대상 | 크기 | 붉은 정도 |
|-------|-----|--------|
| A     | 2   | 2      |
| B     | 2   | 1      |
| C     | 4   | 5      |

그래프 상, 두 점 사이의 거리를 재려면 피타고리스의 정리를 사용한다.
~~~
루트(x1-x2)제곱 + 루트(y1-y2)제곱
~~~

A와 B의 거리는 다음과 같이 계산한다.
= 루트(2-2)제곱 + 루트(2-1)제곱
= 루트 (0+1)
= 루트 1
= 1

나머지 거리도 같은 방법으로 계산할 수 있다.

넷플릭스 고객을 비교한다고 가정해보자.
과일처럼 고객을 그래프에 나타낼 수 있는 방법, 즉 각 고객의 좌표를 계산할 수 있는 방법을 찾아내어 그래프 상에 표현한다.

고객이 처음 넷플릭스에 등록할 때 여러가지 영화 장르에 대한 선호도를 평가하도록 한다.
|      | A | B | C |
|------|---|---|---|
| 코미디 | 3 | 4 | 2 |
| 액션  | 4 | 3 | 5 |
| 드라마 | 4 | 5 | 1 |
| 공포  | 1 | 1 | 3 |
| 로맨스 | 4 | 5 | 1 |

자몽 문제에서는 과일을 두개의 숫자로 나타냈던 것을 다섯 개의 숫자로 나타낸다.
이제는 2차원이 아닌 5차원 상에서 거리를 측정해야 한다.
하지만 거리 계산 공식은 동일하다.

~~~
루트(a1-a2)제곱 + 루트(b1-b2)제곱 + 루트(c1-c2)제곱 + 루트(d1-d2)제곱 + 루트(e1-e2)제곱
~~~

거리를 구하는 공식은 공간의 차원을 유연하게 바꿀 수 있다.
이때의 거리는 두 숫자 집합의 유사도, 즉 두 숫자 집합이 얼마나 비슷한지를 나타낸다.

A와 B의 유사도를 구하면 다음과 같다.
= 루트(3-4)제곱 + 루트(4-3)제곱 + 루트(4-5)제곱 + 루트(1-1)제곱 + 루트(4-5)제곱
= 루트 (1+1+1+0+1)
= 루트 4
= 2

거리가 가까우므로 취향이 비슷하다고 할 수 있다.
B가 어떤 영화를 좋아하면 A에게 추천하고, 반대로 A가 어떤 영화를 좋아하면 B에게 추천하면 된다.
그래서 넷플릭스를 이용하다보면 '더 많은 영화를 평가해주세요', '여러분이 더 많은 영화를 평가할 수도록 추천 영화가 더 정확해집니다'라는 공지를 보게 된다.
더 많은 영화를 평가할 수록 넷플릭스는 다른 고객과의 유사도를 더 정확하게 평가할 수 있기 때문이다.

## Summary
* KNN은 k개의 가장 가까운 이웃 데이터를 이용하여 분류와 회귀 분석을 할 수 있다.
* 분류 = 그룹으로 나누는 작업
* 회귀 = 숫자로 된 반응을 예측
* 특징 추출은 (과일이나 고객과 같은) 항목을 비교 가능한 몇 개의 숫자로 만드는 일이다.
* 좋은 특징을 고르는 것은 성공적인 KNN 알고리즘을 만드는데 있어 중요한 부분이다.